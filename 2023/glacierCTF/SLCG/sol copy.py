from __future__ import annotations
import os, math, sys

ct = [24282832278763385836025269215260907972, 11630534471735424524122966677935104022, 93824507232566975005681342373406592070, 110960810317470708644158660816392787375, 33411220858008836133571960321064615542, 88716520620713350398947322795280501062, 44771624160092497272163269239660198092, 50717856501361992153314130625533338090, 85445730510993302064185688580603503276, 96357303480157649723265694526796080185, 102875569268831562420168244480839729535, 145400656259580890315763626664639502585, 57021113737432747700806009047458281382, 73567943506998230192809577658761687036, 13156442045213039548225279985544313474, 62061676064927560253580744270262865428, 11675954984347530795429144015125703472, 66192207679111798996620881375155541360, 80414240627979162783197661190156659046, 70414140388513438410909334840871445110, 2127532424774682527086807266559820360, 49597972492589386438360797976409826662, 11005819505159836237339620993924508434, 25057121989750465543567411943629013565, 16889954211787430989145669000056859305, 69298909802611043667801769682322657426, 27485858482334468443549630858270579158, 17994072421221453359342380116583361990, 21472312660057126359910677506581689992, 179350598305406302943754254917078160, 29010274679402820435406460244386570344, 644806250968823593227322956753774752, 925099741051481073711068600849155180, 7542750345322424564507842886841013976, 11913039150917618052550515064521618016, 8935085472005233958846463349615113152, 13693558519479756891525606650033062592, 1478486426095080824171635703345311745, 8686875775938652394030681742618762944, 4881920882708328755085972123976066045, 3607675685596300088698490790321071320, 3169879437930880043587631636076745620, 17472053348064238318317959135381913216, 1830382765261036781905446798356867840, 4250586963971182170602921241862553550, 1236285587787287474515970222450890230, 4066304088881577849575188574023267712, 1462101047571445109608512349580424150, 18281311561095308127823254053003630208, 6892428237998978807267743265640181184, 193133551498616332680334224112828608, 74078910783735629270136043258580010, 5963758154171279417187108767062010816, 546683041073805772304072420591925632, 1013043213833212704666165460085755050, 373936441623232200697754913431493780, 2141191618341912529955140658001224448, 4772086734568123151196177484605297664, 285364161379157381606823921672901860, 4832629749703768355836070593782394368, 4640088866092148526083808242478394880, 314087957571991522036661435915780580, 316465546853076675086860520160082020, 440263659264294853018663983481899264, 536302593622046220640835691674060544, 82010846611901398243091432529253680, 383884397762499640314703052402564352, 145564566841524055818704480713254144, 294747895332912233743550207307588864, 555851775704610405488987806862898432, 129525176795141572993552122337114368, 29231623855812945442944022862274360, 
90074477477905411468716661405371648, 371113257480155228786936019915255552, 244155081570175065308001824081168640, 3460573127726567019872194230993408, 379517622549939278035619534064744192, 13614692856725404519487770327790592, 14957399470143957086182898134488576, 5265890253633793748578289218829568, 52581375502754981498211235346094960, 9662228341356943322880389627653632, 5559448740723345069902556083811072, 5287180545943219093597302872633088, 9397878794741408030244141673126656, 128447102468323253941508451582720, 9971525526432166322642092304571840, 3992355259742332909937239002379008, 4701175359417863218559821856090880, 738147955521177437618851531973376, 10818343903627266436759789325028096, 4120300248545536789343828140422912, 2771698087681045329507475990786560, 124027041058309183551832876474368, 22411008912469929498298161568800, 212925261481018459625066263761600, 4917802874185273822002089244162048, 127095426783813021723913069892160, 4606640550922748879090201714319360, 1766576304303571037975251721746944, 74190595339505168414155840374720, 914061599749568422315195967764992, 860831875957832635873785975763968, 8067801959386569799708848932160, 34902657923672592284002275072960, 223810133021563121118414252865536, 1186947615970218518082257432017920, 14218040506235733926193521067840, 34856883830417868294125959944000, 776366419440816083041496907614208, 36285410429621214933563757849600, 5370741048461907648952203422400, 13583987741101659624553118261760, 99175867450053616201119832462848, 2396330053086315738078129185280, 10623193929335566154849355334080, 906131614757836982395397474880, 10599475061672640245567788240320, 234062135080741568086691123172864, 13040698528780104626938733469120, 210920882127397838656133578739712, 11698338418881938074741819959360, 2472577672971264236227347232320, 13152826507284634859472025656000, 13006117354209183109709415495360, 151898520357425353758320397874176, 4309219121537064174633552444480, 54510882504947034569341854658560, 1236775055548985180820792351360, 3868276162901750145429620647680, 752327980881455252105365694400, 3030454053681681995217816560640, 23865650177650811421381762605568, 3576339470096870919148713948480, 33459932839631159301612502017024, 2181065228977685930704481135040, 301886911570402404412577691840, 2444343628064904460695414191040, 2362697680815338003687042907840, 25056993251961037681961024549376, 47213001552685261381753872960, 2073514929675467061899023225344, 110136373826970624573048258240, 140338027957636307470043306880, 102527218665359059772344472640, 115469639446230533271076263360, 6951995139865317122647480573440, 24722012346655117643778507840, 595735524395487305923209237504, 1198375025381300802545277120, 3723506090895826361440903680, 23863688129114257179789705600, 7943888545285423508676849600, 824597016597499152889909168128, 698103809482331787771605760, 641660953136555057734210987008, 265273085704904817063678720, 41608343023170631726682880, 328806666265699041549177600, 399969881363797535873422080, 122510119722201660847195275264, 34083418184130133978606080, 367964889152053330177099776, 101259753828715968403138560, 42743622302223274312819200, 51748420980860544826632960, 98956518583296410102615040, 185639040178644439610604029952, 70506859670479699237843200, 67220979277362126562047541248, 61400234204030728729981440, 43595994873271710903275520, 23904414523060577540789760, 82735543531669900855991040, 26991898487779495428868700160, 26242648805560349732186880, 3498317206654911805467260928, 32479024840442572670277120, 21442317715630970693406720, 40771090362794645305117440, 18359874914266153167770880, 3485634684847029231757608960, 11160575556300653224481280, 1744093390137081140339140608, 15195326486153771593036800, 28127440731208159765693440, 12785259067081812106053120, 12862174228121539882851840, 731554356094243356761763840, 23646767525469144944640, 63019169465530301223966720, 560746586990510903255040, 82217111029326177891840, 349550761764250311690240, 1227880163683450722263040, 996350549868020480088637440, 332469553028714603965440, 891006337404822487844634624, 288120729434062235857920, 125336012668675749319680, 124351120424865790080000, 170194584646707990382080, 1673336531086667360021901312, 124003513732853319644160, 938134182517326328425099264, 71976553936937573760000, 355399772198084135032320, 185967801655629768184320, 319164645018821948144640, 93824332295288771180298240, 269722906575077877857280, 493357888437335104368586752, 24166736518366001203200, 12471200991717366620160, 194015553098843444359680, 119478185955685297336320, 173162244166219120759713792, 104963797844269505395200, 211988295903654309916827648, 104150462285635966471680, 20110807150876410416640, 47954229495636256980480, 44589293364259095667200, 401170530719190035723489280, 
8332175354978839633920, 47773430553345551470817280, 21568437840021818434560, 18790127405963432709120, 45057601231068785149440, 49501175884964996244480, 75561984321416288075575296, 15327829772007843087360, 54579208020594708605865984, 25349933420086925698560, 19475519957847989982720, 20860264888785043107840, 17694576019437297914880, 53042637728991872330366976, 3092461366887159321600, 36824097563977140698370048, 14905700182075494988800, 25767222975832980833280, 18556373991611295452160, 20993464525791746557440, 49563611845252971572256768, 845254079141214643200, 10877746785500169656672256, 645369687622764495360, 437344301657398164480, 589732958542687833600, 2008423429183937180160, 4271387457800772926963712, 133067220109629788160, 2525861058107418721198080, 1458871397886111459840, 941704283642232245760, 235696575894290357760, 1110019358652771479040, 506966891864187418361856, 5502408491604856320, 665895291828990190313472, 1042495210311851520, 7511874024738885120, 2377103044916344320, 17414802318529451520, 810335914872431858270208, 17730620406626526720, 6854721667486829568000, 6582422476582364160, 18492454664851921920, 18165922436953981440, 9777951335595133440, 63187264485788495192064, 13395552908378434560, 37840698016974335950848, 563555892220761600, 9084179813413132800, 12633971785462149120, 11805490210364582400, 98976408610240495927296, 7083038081274347520, 23639784196536880349184, 9090882676159948800, 9390070113975982080, 5334004823384862720, 8473943161756846080, 67213950782329338642432, 305400292458485760, 43781452163542458630144, 770912398512691200, 4473545060515829760, 1553961882960599040, 
807535125801216000, 15786572644670625349632, 700428954405888000, 22317549632088531664896, 386668757183016960, 342580138958407680, 214260994686228480, 106823384902010880, 7008455521493581824, 99528745832478720, 3499956680772335173632, 24907384566835200, 32031107076741120, 17333143952394240, 15492937751562240, 3676476778743361830912, 63807581344573440, 1821465026756543250432, 30523031321333760, 72707639108567040, 41149564632391680, 7559572080015360, 574780635162020413440, 43381055281397760, 1055542681454012596224, 41681827353415680, 137637195632640, 51420914942607360, 38263513534341120, 422048369282318401536, 10053019290746880, 1175192977437359603712, 8517913430261760, 3267622219898880, 11806957109329920, 9074423670128640, 669855706682445987840, 1332974222254080, 891733707947063181312, 4812337464606720, 3961670276874240, 3976046714880000, 1933250975170560, 307334296604858056704, 386774955417600, 238100313975454826496, 1490280278630400, 4698437463244800, 78484349952000, 14975008358400, 36365820874287022080, 43578794188800, 50100406893377224704, 614794696704000, 119427266764800, 557719852032000, 348601240166400, 23897098783053840384, 235784941977600, 23532553197887422464, 217947420057600, 197933115801600, 80407025049600, 170965201305600, 64446514800960208896, 8854039756800, 39295407286522478592, 
11596964659200, 164154470400000, 3971955916800, 51063909580800, 98055453493754855424, 19646580326400, 18770163910686277632, 135598311014400, 77980763750400, 84170708582400, 107828659814400, 27373875061601599488, 13673417932800, 315162857005645824, 8979451084800, 13893783552000, 14710748774400, 7639341465600, 2245375549024763904, 338700340552531968, 933057377083588608, 372679165939286016, 358929446321258496, 1061566833278582784, 8875538841600, 934747318664036352]
test = [(107420468365015388878834701314353199267, 1, 79989744020761045152160018321558671218, 290134767403561903185280291561769480268, 111208554418900487661182904341786298004), (64794810269987160924392281362762800040, 1, 79989744020761045152160018321558671218, 290134767403561903185280291561769480268, 111208554418900487661182904341786298004), (57273817516737598063906183830480397427, 0, 301872833181900647350944557159035077113, 26318712074636953911963817845983212431, 214880571759163918595168184758250970519), (19409551420188568467395314366966659048, 0, 301872833181900647350944557159035077113, 26318712074636953911963817845983212431, 214880571759163918595168184758250970519), (61763558745020903678696493663057312732, 1, 79989744020761045152160018321558671218, 290134767403561903185280291561769480268, 111208554418900487661182904341786298004), (41529840540297653598515578998836378498, 1, 79989744020761045152160018321558671218, 290134767403561903185280291561769480268, 111208554418900487661182904341786298004), (65588651874988956116600501328204290578, 1, 79989744020761045152160018321558671218, 290134767403561903185280291561769480268, 111208554418900487661182904341786298004), (40083978709911128646156276994908495502, 
1, 66325790573746522829351674624781194596, 7721478896210628283555340559006601236, 79940539040056821797744938873680642026), (2532519755601117543328295465464617074, 1, 66325790573746522829351674624781194596, 7721478896210628283555340559006601236, 79940539040056821797744938873680642026), (130907099253577173981585524330841666088, 0, 153959459069881888428186531452822796920, 106522490278240809498788571265236105551, 84163883916279553170565147626011488036), (149480932127919380931672629620626711564, 0, 153959459069881888428186531452822796920, 106522490278240809498788571265236105551, 84163883916279553170565147626011488036), (26291820729144514597170171022531567440, 0, 153959459069881888428186531452822796920, 
106522490278240809498788571265236105551, 84163883916279553170565147626011488036), (11453190070782883578057725955390018134, 1, 66325790573746522829351674624781194596, 7721478896210628283555340559006601236, 79940539040056821797744938873680642026), (26349329225213485631971640236283674382, 1, 66325790573746522829351674624781194596, 7721478896210628283555340559006601236, 79940539040056821797744938873680642026), (63021022914315355266587901246849183194, 1, 51472335945639363698001414245875246598, 32972067507006085464267747301593701486, 52116881451492524963693990237803493162), (48037844803701053552380841157229861758, 1, 51472335945639363698001414245875246598, 32972067507006085464267747301593701486, 52116881451492524963693990237803493162), (23312959617214434574691340434553673848, 1, 51472335945639363698001414245875246598, 32972067507006085464267747301593701486, 52116881451492524963693990237803493162), (94540064859013020833906154881721696020, 0, 153168687866166796170219018879289404032, 48916678266593939260225959096389532028, 135669693055424416982012422938559196624), (20282395789580791745551997432787431196, 1, 51472335945639363698001414245875246598, 32972067507006085464267747301593701486, 52116881451492524963693990237803493162), (79065807839340682620193998046163305472, 0, 153168687866166796170219018879289404032, 48916678266593939260225959096389532028, 135669693055424416982012422938559196624), (23080097849438416022446137476077978064, 0, 153168687866166796170219018879289404032, 48916678266593939260225959096389532028, 135669693055424416982012422938559196624), (50101528064590108265377752963458611114, 1, 14007947189826163035149933042320772956, 4205010413821844115842333431467336120, 687423923517093431727608188231308516), (5609523342382872912558673037584621540, 1, 14007947189826163035149933042320772956, 4205010413821844115842333431467336120, 687423923517093431727608188231308516), (83114978791307903163308742301367981328, 0, 90927768106279250971402795657901322512, 116708433738855593945352438708403008784, 2332168198006968687152127282824172816), (58518430098635312865249989393712711472, 0, 90927768106279250971402795657901322512, 116708433738855593945352438708403008784, 2332168198006968687152127282824172816), (12213226792895606655129902749141410740, 1, 14007947189826163035149933042320772956, 4205010413821844115842333431467336120, 687423923517093431727608188231308516), (11558394757544342237655728112950917088, 1, 14007947189826163035149933042320772956, 4205010413821844115842333431467336120, 687423923517093431727608188231308516), (37617049786284688435854420191238959872, 0, 90927768106279250971402795657901322512, 116708433738855593945352438708403008784, 2332168198006968687152127282824172816), (4163831446171068248993247782387141068, 1, 504141948137985922703750763152004976, 13497559643625262581649879134662741252, 8655461417048568957649752875236645100), (464758675363878644274594773958800812, 1, 504141948137985922703750763152004976, 13497559643625262581649879134662741252, 8655461417048568957649752875236645100), (470879784644605290489263798725358844, 1, 504141948137985922703750763152004976, 13497559643625262581649879134662741252, 8655461417048568957649752875236645100), (440044551074150269882727451228912988, 1, 504141948137985922703750763152004976, 13497559643625262581649879134662741252, 8655461417048568957649752875236645100), (55565879235078912535134138700684518720, 0, 89137132127354332228931155870186993248, 40354088291212733377214314495001890976, 29008743947655755538562214888982989712), (246042642646819694587099789477154796, 1, 504141948137985922703750763152004976, 13497559643625262581649879134662741252, 8655461417048568957649752875236645100), (22168097459691066140980147803003100, 1, 504141948137985922703750763152004976, 13497559643625262581649879134662741252, 8655461417048568957649752875236645100), 
(227868649781831424881355072269720972, 1, 379841429790600015335881040552818652, 297016175298273777707564459237753308, 418505096942818375737407797455376396), (123940036684376135614632418507174988, 1, 379841429790600015335881040552818652, 297016175298273777707564459237753308, 418505096942818375737407797455376396), (79856472312158470256014010475070095408, 0, 65905674201925091264890728981644092368, 76861703682281762737514243683427775984, 84148770118863849056112224463519099984), (240078766066546140499508663207428384, 1, 379841429790600015335881040552818652, 297016175298273777707564459237753308, 418505096942818375737407797455376396), (33265241744491077850219458001517634000, 0, 65905674201925091264890728981644092368, 76861703682281762737514243683427775984, 84148770118863849056112224463519099984), (64787879018991124166325990385821403200, 0, 65905674201925091264890728981644092368, 76861703682281762737514243683427775984, 84148770118863849056112224463519099984), (13890453752213381944043408072945920560, 0, 
65905674201925091264890728981644092368, 76861703682281762737514243683427775984, 84148770118863849056112224463519099984), (40264099807082049921029406412320632, 1, 263957977494862868968944690643174200, 259711324475473176896574269194339824, 84144530227357027361662410121203964), (172973410766302331654090139392681332, 1, 263957977494862868968944690643174200, 259711324475473176896574269194339824, 84144530227357027361662410121203964), (5590798888239871798344525493240977840, 0, 23515369300964634724472210250427325664, 13718412166726570249504742241495409152, 33519244753766953844464264243472232864), (13620515917555099871288680164563625696, 0, 23515369300964634724472210250427325664, 13718412166726570249504742241495409152, 33519244753766953844464264243472232864), (251612867093386676105717774326117132, 1, 263957977494862868968944690643174200, 259711324475473176896574269194339824, 84144530227357027361662410121203964), (23343935901255852551052320075551642080, 0, 23515369300964634724472210250427325664, 13718412166726570249504742241495409152, 33519244753766953844464264243472232864), (62673992471939587064798803399914532, 1, 263957977494862868968944690643174200, 259711324475473176896574269194339824, 84144530227357027361662410121203964), (69498624501316084840135704266757532, 1, 126109451145293416957371843140645332, 79464924010467087801692961151951132, 120093974666503005330922805881023532), (113452755730998759446398164925666912, 1, 126109451145293416957371843140645332, 79464924010467087801692961151951132, 120093974666503005330922805881023532), (19060088057788753905504499042674439392, 0, 16476100766465228398643053698750989952, 6900359561852212322380293919558272288, 9835938782218309283140820896932710976), (108986332249918110278870342882446060, 1, 126109451145293416957371843140645332, 79464924010467087801692961151951132, 120093974666503005330922805881023532), (43036058490734246226490251894848592, 1, 126109451145293416957371843140645332, 79464924010467087801692961151951132, 120093974666503005330922805881023532), (1852362412249679183087394312280302144, 0, 16476100766465228398643053698750989952, 6900359561852212322380293919558272288, 9835938782218309283140820896932710976), (14813678984460415474865996223220040640, 0, 16476100766465228398643053698750989952, 6900359561852212322380293919558272288, 9835938782218309283140820896932710976), (12281109650141314714506050471964860, 1, 120171041050724368044247206138060772, 107291280047379643482149493382522364, 51770868364093714503574158667359640), (27886448540724272893189221814970636, 1, 120171041050724368044247206138060772, 107291280047379643482149493382522364, 51770868364093714503574158667359640), (12342042861120199678483573653205020096, 0, 6573631565889562965516342045153707328, 9149038927475961855411070574336842176, 3294130742796551533565494032071284032), (115781025263226235778947567082582232, 1, 120171041050724368044247206138060772, 107291280047379643482149493382522364, 51770868364093714503574158667359640), (30914116251618507977483568602690772, 1, 120171041050724368044247206138060772, 107291280047379643482149493382522364, 51770868364093714503574158667359640), (1670481306201789839132971168530156480, 0, 6573631565889562965516342045153707328, 9149038927475961855411070574336842176, 3294130742796551533565494032071284032), (5388010596934630838923701616025932800, 0, 6573631565889562965516342045153707328, 9149038927475961855411070574336842176, 3294130742796551533565494032071284032), (51083045676936743024157657903909548, 1, 46654339740551331207661384015278768, 47506954719281072278079178212288320, 90777019436200534871226610739486684), (5914430956035350100081127486098460, 1, 46654339740551331207661384015278768, 47506954719281072278079178212288320, 90777019436200534871226610739486684), (3097416053127649783274339612633474688, 0, 3225529464591917771437243105699354944, 5169691949202001547755925627684590848, 3343637702852297770129766357938408512), (17854483492948520242382218614868668, 1, 46654339740551331207661384015278768, 47506954719281072278079178212288320, 90777019436200534871226610739486684), (39808603690115999686035227589862604, 1, 46654339740551331207661384015278768, 47506954719281072278079178212288320, 90777019436200534871226610739486684), (15097260676915492453305523962402940, 1, 46654339740551331207661384015278768, 47506954719281072278079178212288320, 90777019436200534871226610739486684), (21353004201246680391956899017416412, 1, 46654339740551331207661384015278768, 47506954719281072278079178212288320, 90777019436200534871226610739486684), (39125725341730630111280936407093228, 1, 7722259232172345562537495721109868, 41070388514005768603773171312584460, 8857854438338285668456219555709372), (1627403666885398525815973574094678336, 0, 2802521722235563130576567661048751488, 883200704452973869832268970002192000, 3032458469114464464098844112383940992), (4360220270948956254811126419249320, 1, 7722259232172345562537495721109868, 41070388514005768603773171312584460, 8857854438338285668456219555709372), (1623444849906085201360897346854612, 1, 7722259232172345562537495721109868, 41070388514005768603773171312584460, 8857854438338285668456219555709372), (5750731109649627025441614532856604, 1, 7722259232172345562537495721109868, 41070388514005768603773171312584460, 8857854438338285668456219555709372), (3412340334802962115831147508995508, 1, 7722259232172345562537495721109868, 41070388514005768603773171312584460, 8857854438338285668456219555709372), (453823088632871763989864027080136, 1, 7722259232172345562537495721109868, 41070388514005768603773171312584460, 8857854438338285668456219555709372), (7611602428617670472810076779807680, 1, 3795880651325795424189073555462824, 3398119483194131511598340610940484, 3311543299383099339625316668182324), (816139355097171146881605337616180, 1, 3795880651325795424189073555462824, 3398119483194131511598340610940484, 3311543299383099339625316668182324), (1627453341430600346436164899967572, 1, 3795880651325795424189073555462824, 3398119483194131511598340610940484, 3311543299383099339625316668182324), (992826440910958785529430664823266432, 0, 857949025875764328431159103901572480, 887938788626573171087068890557322240, 1397531325190597233827306981397022080), (371325902611850933970577632397388, 1, 3795880651325795424189073555462824, 3398119483194131511598340610940484, 3311543299383099339625316668182324), (282207527042054750548721846456572, 1, 3795880651325795424189073555462824, 3398119483194131511598340610940484, 3311543299383099339625316668182324), (1515467763183753497062638862268996, 1, 3795880651325795424189073555462824, 3398119483194131511598340610940484, 3311543299383099339625316668182324), (3225431451506053682421604306295020, 1, 390578139259523707888727797992332, 549839751262910669109859102506316, 1976830103607361892530677109988324), (151668818584698146239325922510744, 1, 390578139259523707888727797992332, 549839751262910669109859102506316, 1976830103607361892530677109988324), (239468766350225382861849457091579520, 0, 39712048286214541726290192084028800, 582745959815343475362066379024260480, 562212865130298330645318416956709760), (293200230459868948925934486153780, 1, 390578139259523707888727797992332, 549839751262910669109859102506316, 1976830103607361892530677109988324), (264712834351085820002180940778224, 1, 390578139259523707888727797992332, 549839751262910669109859102506316, 1976830103607361892530677109988324), (305129666434412158614776005572704, 1, 390578139259523707888727797992332, 549839751262910669109859102506316, 1976830103607361892530677109988324), (247773425281089617713560568862556, 1, 390578139259523707888727797992332, 549839751262910669109859102506316, 1976830103607361892530677109988324), (51948498143070118202825713349284, 1, 315528370272363409766551466607888, 207961612962874372822620807396424, 365947790344863994130229274208288), (229301543949412533607952007093696, 1, 315528370272363409766551466607888, 207961612962874372822620807396424, 365947790344863994130229274208288), (137092584247079327175433287835808, 1, 315528370272363409766551466607888, 207961612962874372822620807396424, 365947790344863994130229274208288), (29173134635329472689623361878044160, 0, 1446894729537512517526176576207360, 3306153446506589515447766015381760, 6818130276223149022311773614719360), (15268385945391440107906778751360, 0, 1446894729537512517526176576207360, 3306153446506589515447766015381760, 6818130276223149022311773614719360), (165971775438113427302788216844176, 1, 315528370272363409766551466607888, 207961612962874372822620807396424, 365947790344863994130229274208288), (765152229920330250360928524412800, 0, 1446894729537512517526176576207360, 3306153446506589515447766015381760, 6818130276223149022311773614719360), (170787692099442899940122802459728, 1, 176775218647305559154066266727504, 279725697252552650098504651480720, 98663799928833219383110300765200), (126394082938438597906370634454800, 1, 176775218647305559154066266727504, 279725697252552650098504651480720, 98663799928833219383110300765200), (520709458813020194937787935838080, 0, 1055528150365100943245415591792000, 162618842895746789248317159684480, 766327858274243830130084676551040), (44838058319066033336316810563136, 1, 176775218647305559154066266727504, 279725697252552650098504651480720, 98663799928833219383110300765200), (23922136079885369771567236096288, 1, 176775218647305559154066266727504, 279725697252552650098504651480720, 98663799928833219383110300765200), (413324823352756405999025457757440, 0, 1055528150365100943245415591792000, 162618842895746789248317159684480, 766327858274243830130084676551040), (719717080688612608359616346010240, 0, 1055528150365100943245415591792000, 162618842895746789248317159684480, 766327858274243830130084676551040), (29665372975982640753491218637216, 1, 129174415766011320680952782718128, 119430746029036704461727956197856, 121464955444735302996929136803680), (70444561401436308638213838367840, 1, 129174415766011320680952782718128, 119430746029036704461727956197856, 121464955444735302996929136803680), (868877833360668847468906649898240, 0, 111081480847210929572939218314240, 1002038975719632280535323016154240, 869768000393058680134644409962240), (51658882811507639577044943763200, 0, 111081480847210929572939218314240, 1002038975719632280535323016154240, 869768000393058680134644409962240), (51599661995668200929538563319424, 1, 129174415766011320680952782718128, 119430746029036704461727956197856, 121464955444735302996929136803680), (16477002884091566881878358982400, 0, 111081480847210929572939218314240, 
1002038975719632280535323016154240, 869768000393058680134644409962240), (50592257664642999271978011452160, 0, 111081480847210929572939218314240, 1002038975719632280535323016154240, 869768000393058680134644409962240), (117682403896884365538792714022544, 1, 76420043927798968707392159894480, 85337682326496322074346113803056, 77054569756330509318116690294704), (9411291690288800285595002755168, 1, 76420043927798968707392159894480, 85337682326496322074346113803056, 77054569756330509318116690294704), (69845098675336167577701865857072, 1, 76420043927798968707392159894480, 85337682326496322074346113803056, 77054569756330509318116690294704), (35980765034804133502112525297216, 1, 76420043927798968707392159894480, 85337682326496322074346113803056, 77054569756330509318116690294704), (69184314677883852155983421568480, 1, 76420043927798968707392159894480, 85337682326496322074346113803056, 77054569756330509318116690294704), (89147043723678714857961427818240, 0, 33254096386162265723387949776640, 37989339588484689392235271883520, 9357167659259790043295638613760), (46266345125026023036022963024224, 1, 76420043927798968707392159894480, 85337682326496322074346113803056, 77054569756330509318116690294704)]

class LCG:
    def __init__(self, mod: int, mult: int, add: int, seed: int):
        self.mod = mod
        self.mult = mult
        self.add = add
        self.value = seed

    def __next__(self) -> int:
        self.value = (self.value * self.mult + self.add) % self.mod
        return self.value

    def __iter__(self) -> LCG:
        return self

    @classmethod
    def random_values(cls):
        return LCG(
            int.from_bytes(os.urandom(16)),
            int.from_bytes(os.urandom(16)),
            int.from_bytes(os.urandom(16)),
            int.from_bytes(os.urandom(16))
        )

important = ct[7 * 4: 7 * 5]
important = important[:4] + important[5:]
test = test[7 * 4: 7 * 5]
test = test[:4] + test[5:]
mod, mult, add = test[0][2], test[0][3], test[0][4]
lcg = LCG(mod, mult, add, important[0])

# for i, t in zip(important, test):
#     print(i, next(lcg))

b_values = []
for a1, a2, a3 in zip(important, important[1:], important[2:]):
    b_values.append((a1 - a2, a2 - a3))
    print((mult * b_values[-1][0]) % mod == b_values[-1][1] % mod)

divided = []
for b_value in b_values[1:]:
    divided.append(b_values[0][0] * b_value[1] - b_values[0][1] * b_value[0])

for d in divided:
    print(d % mod)

print(divided)
print(math.gcd(*divided))
print(mod)
print(math.gcd(*divided) / mod)
max_mod = math.gcd(*divided)
i = 0
while True:
    i += 1
    if i == 100:
        break
    print(f"{i=}")
    if max_mod % i != 0:
        continue

    try_mod = max_mod // i
    print(try_mod)
    # find b:
    # print("factorizing", try_mod)
    # primes = prime_factorization(try_mod)
    # print("factorized")
    # rems = []
    # for prime in primes:
    #     rems.append((pow(b_values[0][0], -1, prime) * b_values[0][1]) % prime)
    # min_try_b = chinese_remainder(primes, rems)
    gcd = math.gcd(b_values[0][0], try_mod)
    left = b_values[0][0] % try_mod // gcd
    while (gcd:=math.gcd(left, try_mod)) != 1:
        left //= gcd
    print(math.gcd(left, try_mod))

    # assert b_values[0][0] * mult % mod == b_values[0][1] % mod
    e = (b_values[0][1] * pow(left, -1, try_mod)) % try_mod
    # assert b_values[0][0] % left == 0
    divisor = b_values[0][0] % try_mod // left
    if e % divisor != 0:
        continue
    # assert divisor * mult % try_mod == e
    min_b = e // divisor

    print(min_b)
    print(mult)
    print(mult % min_b)

    for j in range(1, divisor + 1):
        print(f"{j=}")
        try_b = min_b * j
        try_c = (important[1] - try_b * important[0]) % try_mod

        lcg = LCG(try_mod, try_b, try_c, important[-1])
        lcg = LCG(
                    next(lcg), next(lcg),
                    next(lcg), next(lcg)
                )
        # values = []
        # for _ in range(5):
        #     values.append(next(lcg))
        
        # if all(x in ct for x in values):
        nxt = next(lcg)
        if nxt in ct:
            print("found it!!!", try_mod, try_b, try_c)
            print(mod, mult, add)

            bits = ""
            for x in range(7 * 5, len(ct), 7):
                bits += "0"
                for y in ct[x: x + 7]:
                    if y == nxt:
                        bits += "1"
                        nxt = next(lcg)
                    else:
                        bits += "0"
                lcg = LCG(
                    nxt, next(lcg),
                    next(lcg), next(lcg)
                )
                nxt = next(lcg)

            ascii_bits = int(bits, 2)
            print(ascii_bits.to_bytes(55))

            sys.exit()
