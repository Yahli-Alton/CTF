import z3


nbit = 1024
# p = 9759214226566479178492122025079085110672923154237857866132541209515290748256682447639233500741647566508886067763157041721925656937742468493458712915822941
# a = 8263130964793137696017687940167847203177532361615858370912450938820060084916653247047449278048188899853641852550517697817817229037502751897796209365331
# b = 70
# c = 11677098444049404543429020403643669058707047382000102765138450045951029853156302041038234628984628124301244716477565994069171688584906483209254381387563
# d = 726
# e = 15040890449276065888817802842462479540627403648892594173393158159344962283690409241207181402606341018146989843162645947050491473559807094726896264630101800532122666787696666017222837867588157781687514115995473041493375559928704513560825109764158879266720733936539970908139500009914432678823136317836030372810110581506174846514411292834702004049054864216000763398197406230349989763066374306451801648587678663717177116797818824128501570683447319521490989102216643780270352386077498241936998520493447977796305887436128288959439753853636083609142354324769903148649170755854774958008960622651822445016978511676766033
u = 6411172230159006700227408771288572697823798761459209539863098178841347029930452104591762418541130983751911240467037849160662778176664106984624249205573791678537145101443165495592470651701137799828294147201998288812416829225249829234950008036269276678681001205727066769315707466205927926203791461267200835000528493197489303099625552466088246237827819660154681556104758609299943734845123540547956739072695829288936905647949290390736736014899120848134990257411732566144803520303058331249814746207690984296330571169633656013221598745936086635277584260712334520357168212173919059266365090918204576554257124934091878
v = 8629718219117059188590394071173906842803604887433384633530059980503615253759957136615418984065210034395078602695608097889828695383142987742272015424528008853585521686253500521630367215887019981859219968793474752680958730703454684325875101727889602588039732730812904138823792543708504752619344856568829537809582088308685543414785740368613757811227044555846081842092647621050046028221250765903844909514982834428240211149869533737764834668548198673355998844804911214125548865774439910687183774285756993499975316266494632946218155107699996973864770064057568628292002543680855898742595531733617868462721386742673873
n = 9189868148919021556976428957955387227383494207192445001151909919483409922328878471203387737525419955773194927818101452688450121612528870454223029311625293742311444431312850817580673083059389320474370251557258260652287263153351356660822981468533962349022721083938547388510796459358823759934482767161738889120155282662671413660382641099334880954286788972943221161532577757727401598322077983745032443293682532364799657407967135795175141498263230955566647979939946128838859248684900253392511562545935361621325595915277303621658837536045854900699831323779793061949932745067964433832954181254793388016492935610300369

p = z3.Int("p")
a = z3.Int("a")
b = z3.Int("b")
c = z3.Int("c")
d = z3.Int("d")
# y = z3.Int("y")
# z3.solve(0 < p, p < 2 ** (nbit // 2 + 1), 0 < y, y < 2 ** (nbit // 2 + 1), v == -(p + u * y) % n)
# z3.solve(0 < p, 0 < y, v == -(p + u * y))
z3.solve(n == p ** 2 * a * b + p * (a * d + b * c) + b * d,
         n % (p ** 2) == p * (a * d + b * c) + b * d,
         n % p == b * d,
         0 <= b, b < 1000,
         0 <= d, d < 1000)
